---
tags: Java/Многопоточность
---
Простейший, путь – явно создать два объекта типа **Thread**, передать им инстансы **Runnable**, с нужными задачами в реализации их методов **run**, и запустить вызвав **thread.start().** Если в основном потоке нужно дождаться завершения задач, то после **start()** вызывается метод **[[Thread join|thread.join()]]**. Исполнение зависнет на вызове этого метода до тех пор, пока поток не закончит свою задачу и не умрет. Вся работа задач с внешними данными должна быть синхронизирована.

>[!Warning]
>Такое ручное создание тредов полезно в учебных целях, но **считается плохой практикой в промышленном коде**: само создание – дорогостоящая операция, а большое количество случайно созданных потоков может приводить к проблеме голодания потоков (starvation).
>
В качестве **продвинутой альтернативы** используются **пуллы потоков** – реализации интерфейса **ExecutorService**.

![[Tread pool.png]]

## Пул потоков (реализации интерфейса **ExecutorService**)
Такие сервисы создаются статическими фабричными методами **класса Executors (исполнители)**. Они умеют принимать задачи в виде **Runnable**- или **Callable**- объектов на заранее созданном наборе потоков (собственно, пулле).
[[Отличие Runnable от Callable]]

Кроме самого пулла, экземпляры **ExecutorService** содержат **фабрику потоков** («инструкцию» как создать тред при необходимости), и **коллекцию-очередь задач** на исполнение (см. рисунок).

Пример:
```java
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class Main {
    public static void main(String[] args) {
        ExecutorService executorService = Executors.newFixedThreadPool(2);

        executorService.execute(() -> {
            // Логика выполнения задачи 1
            System.out.println("Выполняется задача 1");
        });

        executorService.execute(() -> {
            // Логика выполнения задачи 2
            System.out.println("Выполняется задача 2");
        });

        executorService.shutdown(); // Завершение ExecutorService

        // Дополнительный код после завершения задач
        System.out.println("Все задачи отправлены на выполнение.");

        // Проверка, завершились ли все задачи
        while (!executorService.isTerminated()) {
            // Ожидание завершения задач
        }

        System.out.println("Все задачи завершены.");
    }
}


```

![[Thread pool.png]]

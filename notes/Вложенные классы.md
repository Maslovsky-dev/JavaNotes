---
tags: Java/ООП
---
Вложенный класс должен создаваться только для того, чтобы обслуживать обрамляющий его класс (почка). Если класс оказывается полезен в каком-либо ином контексте, он должен стать классом верхнего уровня.
**Пример:** ![[Пример вложенного класса.png]]
Класс Iterator помещаем внутрь класса ArrayList (итератор, должен помнить коллекцию, которую он обходит, чтобы получать элементы и текущую позицию обхода). Добиваемся этого, поместив определение итератора внутрь класса ArrayList.

Таким образом, каждый экземпляр итератора будет иметь собственное состояние (int cursor), хранящееся в полях, а также неявную ссылку на экземпляр внешнего класса. То есть из итератора можно напрямую обращаться к полям класса ArrayList (elementData).

>[!tip] Классы верхнего уровня может иметь только **public** и **default** модификаторы доступа
## Особенности вложенных классов

### Когда применяются вложенные классы
Внутренний класс ведет себя как обычный класс за тем исключением, что его **объекты могут быть созданы только внутри внешнего класса.**

Внутренний класс имеет **доступ ко всем полям внешнего класса**, в том числе закрытым с помощью модификатора private. Аналогично внешний класс имеет доступ ко всем членам внутреннего класса, в том числе к полям и методам с модификатором private.

Ссылку на объект внешнего класса из внутреннего класса можно получить с помощью выражения Внешний_класс.this, например, Person.this.

Объекты внутренних классов могут быть созданы только в том классе, в котором внутренние классы определены. В других внешних классах объекты внутреннего класса создать нельзя.

**Не статический**: если вложенный класс должен быть виден за пределами одного метода или он слишком длинный для того, чтобы его можно было удобно разместить в границах одного метода и, если каждому экземпляру такого класса необходима ссылка на включающий его экземпляр.
**Статический**: если ссылка на обрамляющий класс не требуется.
**Локальный**: если класс необходим только внутри какого-то метода и требуется создавать экземпляры этого класса только в этом методе.
**Анонимный**: если к тому же применение класса сводится к использованию лишь в одном месте и уже существует тип, характеризующий этот класс.

### Каким образом из вложенного класса получить доступ к полю внешнего класса
Статический вложенный класс **имеет прямой доступ ТОЛЬКО к статическим полям** обрамляющего класса.

Простой внутренний класс, может обратиться к любому полю внешнего класса напрямую. В случае, если у вложенного класса уже существует поле с таким же литералом, то обращаться к такому полю следует через ссылку на его экземпляр.
Например: Outer.this.field (Outher - название внешнего класса)

## Локальный класс
Локальный класс — это вложенный класс, объявленный внутри другого класса и некоторого блока кода этого класса, то есть объявленный между фигурными скобками {}. Этот блок может быть [[Блоки инициализации|статическим блоком]], циклом, телом if и т.д.

Можно объявить вложенный класс внутри блока кода, например метода, конструктора или блока инициализации. Он будет называться локальным вложенным классом. Чаще всего локальные классы объявляются внутри тела метода.

**Локальные классы имеют следующие особенности:**
- Видны только в пределах блока, в котором объявлены;
- Не могут быть объявлены как private/public/protected или static;
- Не могут иметь внутри себя статических объявлений (полей, методов, классов);
- Имеют доступ к полям и методам обрамляющего класса;
- Могут обращаться к локальным переменным и параметрам метода, если они объявлены с модификатором final.

## [[Анонимные классы]]

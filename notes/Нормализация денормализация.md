---
tags: SQL
---
Нормализация – процесс удаления избыточных данных. Это метод проектирования
БД, который позволяет привести базу к минимальной избыточности.

**Избыточность данных** – это ситуация, когда одни и те же данные хранятся в базе в нескольких местах (таблицах). Именно это и приводит к аномалиям.

Нормализация нужна для:
- устранения аномалий
- повышения производительности
- повышения удобства управления данными

Базовые принципы реляционной теории:
- порядок строк не имеет значения
- порядок столбцов не имеет значения

## Первая нормальная форма 1НФ
- В таблице НЕ должно быть дублирующих строк
- В каждой ячейке таблицы хранится атомарное значение (одно НЕ составное)
- В столбце хранятся данные одного типа
- Отсутствуют массивы и списки в любом виде (операции над массивами не атомарны)
![[1НФ нормальная форма.png]]
![[Приведение к ПНФ.png]]
## Вторая нормальная форма 2НФ
- Таблица должна находиться в 1НФ
- Таблица должна иметь ключ
- Все неключевые столбцы должны зависеть от полного ключа (в случае, если ключ составной)
**Пример**: человек и его паспорт. По серии и номеру (составной ключ) можно определить уникального человека.

>[!note]
>Отношение находится во 2НФ, если оно находится в 1НФ и каждый не ключевой атрибут неприводимо зависит от Первичного Ключа (ПК).

Неприводимость означает, что в составе потенциального ключа отсутствует меньшее подмножество атрибутов, от которого можно также вывести данную функциональную зависимость. Например, дана такая таблица с составным ключом (модель + фирма):
![[Пример 2НФ.png]]
Таблица находится в первой нормальной форме, но не во второй. Цена машины зависит от модели и фирмы (составной ключ). Скидка зависят ТОЛЬКО от фирмы, то есть зависимость от первичного ключа неполная.
Исправляется это путем декомпозиции на два отношения, в которых не ключевые
атрибуты зависят от первичного ключа ПК. **Декомпозиция**
![[Приведение к 2НФ.png]]
## Третья нормальная форма 3НФ
- Таблица должна находиться во 2НФ
- В таблицах отсутствует транзитивная зависимость

>[!note]
Отношение находится в 3НФ, когда находится во 2НФ и **каждый не ключевой атрибут** не транзитивно зависит от первичного ключа. Проще говоря, второе правило требует выносить все не ключевые поля, содержимое которых может относиться к нескольким записям таблицы в отдельные таблицы.

Таблица находится во 2НФ, но не в 3НФ:
![[Пример 3НФ.png]]
В отношении атрибут «Модель» является первичным ключом. Личных телефонов у автомобилей нет, и телефон зависит исключительно от магазина.
Таким образом, в отношении существуют следующие функциональные зависимости:
Модель → Магазин, Магазин → Телефон, Модель → Телефон. Зависимость Модель → Телефон является транзитивной, следовательно, отношение не находится в 3НФ.
В результате разделения исходного отношения
получаются два отношения,
![[Приведение к 3НФ.png]]

находящиеся в 3НФ → Магазин → Телефон
Модель → Магазин


[[Влияние денормализации на производительность SQL запросов]]
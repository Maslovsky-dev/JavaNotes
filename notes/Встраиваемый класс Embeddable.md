---
tags: ORM
--- 
Встраиваемый класс (Embeddable class) является классом, который может быть встроен в другой класс и рассматриваться как его составная часть. Вместо того чтобы создавать отдельную таблицу для встраиваемого класса, его поля сохраняются непосредственно в таблице, которая содержит владеющий класс.

Hibernate, как ORM-фреймворк, поддерживает встраиваемые классы и позволяет включать их в основной класс с помощью аннотации `@Embeddable` или XML-конфигурации.

Пример встраиваемого класса с использованием аннотаций в Hibernate:

```java
@Embeddable
public class Address {
    private String street;
    private String city;
    private String zipCode;
    // Геттеры и сеттеры
}
```

Затем владеющий класс может включать встраиваемый класс как одно из своих полей:

```java
@Entity
public class Person {
    @Id
    private Long id;
    private String name;
    
    @Embedded
    private Address address;
    
    // Геттеры и сеттеры
}
```

В этом примере класс `Address` является встраиваемым классом. Поле `address` в классе `Person` помечено аннотацией `@Embedded`, чтобы указать Hibernate, что объект `Address` должен быть включен в таблицу `Person`.

При сохранении или извлечении объекта `Person` Hibernate автоматически сохраняет и извлекает значения полей `Address` в той же таблице, где хранятся поля `Person`.

Встраиваемые классы полезны в ситуациях, когда имеется сильная связь между двумя классами, и встраиваемый класс не имеет собственной жизненного цикла и существует только в контексте владеющего класса. Они позволяют структурировать данные и улучшают читаемость и поддерживаемость кода.

## Особенности встраиваемых классов
- все поля встраиваемого класса, даже коллекции, станут полями класса, в который происходит встраивание 
- встраиваемые классы могут быть встроены в одну и ту же сущность несколько раз, нужно только поменять имена полей 
- экземпляры встраиваемых классов, в отличие от экземпляров сущностей, не имеют собственного персистентного состояния, вместо этого они существуют только как часть состояния объекта, которому они принадлежат 
- встраиваемые классы могут использовать в качестве полей: 
- базовые типы; 
- коллекции базовых типов (с аннотацией @ElementCollection)
-  другие встраиваемые классы; 
- коллекции других встраиваемых классов (с аннот-ей @ElementCollection); 
- сущности; 
- коллекции сущностей; 
-- сущность может использовать в качестве полей одиночные встраиваемые классы и коллекции встраиваемых классов; 
- встраиваемые классы могут использоваться в качестве ключей и значений Map.

>[!Note]
>Встраиваемый класс помечается аннотацией @Embeddable. Встраиваемый класс может быть встроен в несколько классов-сущностей, но встроенный объект с конкретным состоянием принадлежит исключительно владеющей им сущности и не может использоваться одновременно другими сущностями, он НЕ является общим для нескольких сущностей.
>
>Так, во встраиваемый класс мы можем выделить общие поля для разных сущностей, не
создавая для него таблицу. Встраиваемый класс сам не является сущностью.


## Требования JPA к встраиваемым классам
Должны соответствовать требованиям для сущностей (за исключением того, что у встраиваемых классов не ставится аннотация @Entity и может отсутствовать первичный ключ (@Id)).
![[Встраиваемые класса Embedded.png]]
Должны быть аннотированы @Embeddable.

## Для чего нужны аннотации @Embedded и @Embeddable?

@Embeddable Аннотация JPA, размещается над классом для указания того, что класс является встраиваемым в другие классы и будет внедрен другими сущностями, то есть поля этого встраиваемого класса будут добавляться к полям других сущностей и будут представлять столбцы в таблице этой сущности.

@Embedded аннотация JPA, используется для размещения над полем в классе-сущности для указания того, что внедряется встраиваемый класс.

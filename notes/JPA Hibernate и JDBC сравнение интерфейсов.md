---
tags: Java/JDBC, ORM
--- 

[[JPA Hibernate ORM]], [[JDBC]]

| JPA                  | JDBC по аналогии | Hibernate      |
| -------------------- | ---------------- | -------------- |
| EntityManagerFactory | DataSource       | SessionFactory |
| EntityManager        | Connection       | Session        |
| JPQL                 |                  | HQL            |


**JPQL (Java Persistence query language)** это язык запросов, практически такой же как SQL, однако вместо имен и колонок таблиц базы данных, он использует имена классов Entity и их атрибуты. В качестве параметров запросов так же используются типы данных атрибутов Entity, а не полей баз данных.

В отличии от SQL в JPQL есть автоматический полиморфизм (см. следующий вопрос).
Также в JPQL используется функции, которых нет в SQL: такие как KEY (ключ Map’ы), VALUE (значение Map’ы), TREAT (для приведения суперкласса к его объекту-наследнику, downcasting), ENTRY и т.п.

## Что означает полиморфизм в запросах JPQL и как его «выключить»?

В отличии от **SQL** в запросах **JPQL есть автоматический полиморфизм**, то есть каждый запрос к Entity возвращает не только объекты этого Entity, но также объекты всех его классов-потомков, независимо от стратегии наследования (например, запрос `select * from Animal`, вернет не только объекты Animal, но и объекты классов Cat и Dog, которые унаследованы от Animal).

Чтобы исключить такое поведение используется функция TYPE в where условии
(например `select * from Animal a where TYPE(a) IN (Animal, Cat)` уже не вернет
	объекты класса Dog).

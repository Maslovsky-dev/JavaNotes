---
tags: ORM
---
Аннотация `@GeneratedValue` в Hibernate используется для указания, как значение первичного ключа (идентификатора) сущности будет автоматически генерироваться при сохранении в базу данных.

`@GeneratedValue` может быть применена к полю или геттеру/сеттеру, которые представляют первичный ключ сущности. Она работает в сочетании с другой аннотацией, такой как `@Id`, которая указывает, что поле является первичным ключом.

1. `GenerationType.AUTO` (по умолчанию): Hibernate самостоятельно выбирает стратегию генерации в зависимости от базы данных. Например, для базы данных MySQL это может быть ==стратегия `IDENTITY`, а для PostgreSQL - `SERIAL`.==

2. `GenerationType.IDENTITY`: Используется для автоматической генерации значения первичного ключа с использованием автоинкрементных столбцов, поддерживаемых некоторыми базами данных.

3. `GenerationType.SEQUENCE`: Используется для генерации значения первичного ключа с использованием **базовой последовательности**. Не все базы данных поддерживают это, и требуется настройка соответствующей последовательности в базе данных.

4. `GenerationType.TABLE`: Используется для генерации значения первичного ключа с использованием специальной таблицы, в которой хранятся значения для каждой сущности. Это универсальный способ генерации, поддерживаемый всеми базами данных, но может быть неэффективным при большом количестве записей.

Пример использования `@GeneratedValue` с `GenerationType.IDENTITY`:
```java
@Entity
public class Product {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    // ...
}
```

В этом примере, поле `id` класса `Product` помечено аннотацией `@Id` для указания, что это первичный ключ. `@GeneratedValue` указывает, что значение первичного ключа будет автоматически генерироваться с использованием стратегии `GenerationType.IDENTITY`. Это означает, что значение будет автоматически увеличиваться при вставке новой записи в базу данных с поддержкой автоинкрементных столбцов.

## Если установить стратегию генерации ключа AUTO, то какую из типов стратеги Hibernate САМ никогда не выберет и почему?
Если установить стратегию генерации ключа AUTO, то Hibernate сам никогда не выберет стратегию IDENTITY. Это связано с тем, что стратегия IDENTITY требует, чтобы таблица имела столбец с типом данных IDENTITY, а не все таблицы имеют такой столбец.

Если вам нужна стратегия генерации ключа, которая не зависит от столбца таблицы, вы можете использовать стратегию SEQUENCE или TABLE. Стратегия SEQUENCE использует последовательность для генерации ключей, а стратегия TABLE использует таблицу для генерации ключей.

Стратегия SEQUENCE является более предпочтительной, чем стратегия TABLE, поскольку она более эффективна. Однако стратегия TABLE может быть необходима, если вы не можете использовать последовательности.

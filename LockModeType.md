---
tags: ORM
---
1. **NONE**: Нет блокировки. Другие транзакции могут свободно изменять данные, не ожидая завершения текущей транзакции.
2. **OPTIMISTIC**: Оптимистическая блокировка. При сохранении изменений JPA проверяет, не были ли данные изменены другими транзакциями после момента загрузки. Если данные были изменены, будет выброшено исключение `OptimisticLockException`.
3. **OPTIMISTIC_FORCE_INCREMENT**: Аналогично `OPTIMISTIC`, но также инкрементирует версионное поле сущности (если такое есть) даже в случае, если данные не были изменены. Это может быть полезно, чтобы обеспечить актуальность версии.
4. **PESSIMISTIC_READ**: Пессимистическая блокировка для чтения. Заблокирует запись для чтения и другие транзакции не смогут прочитать или изменить эту запись до завершения текущей транзакции.
5. **PESSIMISTIC_WRITE**: Пессимистическая блокировка для записи. Заблокирует запись для изменения и другие транзакции не смогут изменить или прочитать эту запись до завершения текущей транзакции.
6. **PESSIMISTIC_FORCE_INCREMENT**: Аналогично `PESSIMISTIC_WRITE`, но также инкрементирует версионное поле сущности (если такое есть) даже в случае, если данные не были изменены.

Пример использования `LockModeType`:
```java
EntityManager em = ...; // Получение EntityManager

Book book = em.find(Book.class, 1L);
em.lock(book, LockModeType.PESSIMISTIC_WRITE);

// Теперь запись заблокирована для изменения

```

## FORCE_INCREMENT
может быть полезным в случаях, когда требуется обеспечить, чтобы версионное поле всегда менялось после завершения транзакции. Это может быть важно для систем, которые могут следить за последовательностью транзакций или для управления кэшированием данных.

Вот некоторые сценарии, в которых инкрементация версионного поля, даже при отсутствии фактических изменений, может иметь смысл:

1. **Контроль за последовательностью транзакций**: Инкрементация версионного поля после каждой транзакции может помочь следить за последовательностью событий и контролировать обновления.
2. **Избежание бесконечной блокировки**: Если две транзакции взаимодействуют между собой, инкрементация версионного поля может помочь избежать бесконечного цикла блокировки.
3. **Обновление кэшированных данных**: Если данные кэшируются, инкрементация версионного поля гарантирует, что кэшированные данные будут обновляться даже при отсутствии фактических изменений.

В итоге, инкрементация версионного поля в режиме `OPTIMISTIC_FORCE_INCREMENT` может быть полезным в некоторых сценариях, где требуется более строгое управление версией данных для обеспечения целостности и согласованности данных.

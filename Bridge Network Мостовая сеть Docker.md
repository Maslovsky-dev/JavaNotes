---
tags: Микросервисы
---

Чтобы добавить ваши контейнеры в мостовую сеть и обеспечить между ними взаимодействие, вам следует выполнить следующие шаги:

1. **Создание мостовой сети**: Сначала создайте мостовую сеть с помощью команды
```bash 
docker network create my-bridge-network
```
Здесь `my-bridge-network` - это имя вашей создаваемой сети.

2. **Запуск контейнеров с добавлением в сеть**: Запустите ваши контейнеры, используя созданную мостовую сеть. Укажите опцию `--network`, чтобы добавить контейнеры в эту сеть:
```bash
docker run -d --network=my-bridge-network --name=web-app-container your-web-app-image
docker run -d --network=my-bridge-network --name=db-container your-database-image
```
Здесь `your-web-app-image` и `your-database-image` - это имена ваших образов для веб-приложения и базы данных соответственно.

3. **Конфигурация взаимодействия**: Теперь ваши контейнеры будут в одной мостовой сети и смогут взаимодействовать друг с другом. Веб-приложение может обращаться к базе данных по имени контейнера (DNS-имя контейнера), которое будет разрешаться в IP-адрес между контейнерами в данной сети.

4. **Настройка веб-приложения**: В вашем веб-приложении, чтобы обратиться к базе данных, используйте **DNS-имя контейнера** базы данных в качестве хоста. Например, если вы использовали имя `db-container` для вашего контейнера базы данных, то в настройках вашего веб-приложения укажите этот контейнер как хост базы данных.

>[!note]+ Примечание:
>
> Контейнер, работающий с внешней сетью, может иметь свой IP-адрес внутри сети, и другие контейнеры могут обращаться к нему по этому IP-адресу, однако использование DNS-имени контейнера обычно более гибко и облегчает масштабирование и изменение конфигурации.

## Пример приложения и базы данных
**Доступ к бд из внутренней сети контейнеров docker**

Предположим, что вы запустили базу данных в контейнере и указали, что порт 3306 контейнера (стандартный порт для MySQL) должен быть проброшен на порт 3306 хостовой машины:

```bash
docker run -d --network=my-bridge-network --name=db-container -p 3306:3306 your-database-image
```

Затем вы можете настроить ваше веб-приложение так, чтобы оно подключалось к базе данных по адресу `db-container` (имя контейнера) и порту `3306`. Например, если ваше веб-приложение использует стандартный порт MySQL, то вы можете указать `db-container:3306` в настройках подключения к базе данных.

```yaml
database:
  host: db-container
  port: 3306
```

Таким образом, ваше веб-приложение будет обращаться к базе данных через имя контейнера и порт, который вы пробросили на хостовую машину.

Обратите внимание, что при использовании сетей Docker, контейнеры могут обращаться друг к другу по именам контейнеров внутри сети, а также по IP-адресам. В данном случае, использование имени контейнера и проброшенных портов упрощает настройку и обеспечивает более гибкое взаимодействие.

## Пробрасываем внешний порт от базы данных
**Для доступа к порту контейнера бд из внешней сети**, вам нужно будет выполнить проброс порта через хостовую машину наружу. Это может быть полезным, например, если вы хотите, чтобы внешние клиенты могли подключаться к вашей базе данных.

**Для проброса порта наружу, вы можете использовать опцию `-p`** при запуске контейнера, указав порт хостовой машины и порт контейнера:

```bash
docker run -d -p 3306:3306 --network=my-bridge-network --name=db-container your-database-image
```

Теперь порт 3306 контейнера будет доступен как на хостовой машине, так и из внешней сети, если правила брандмауэра и настройки сетевой безопасности позволяют доступ к этому порту.

Пожалуйста, будьте осторожны с открытием портов контейнеров внешней сети, особенно при работе с базами данных, чтобы обеспечить безопасность вашего приложения.
